# technology 決策 guide ## overview 本 file 用於 record MKing Friend project 的最終 technologychoice 決策，並 provide 相關 file 的 updatingguide。in 閱讀了 [back 端 technology 棧 detailedcomparison](./backend-technology-comparison.md) back，請 use 此 file 來 record 您的最終 decision。 ## 決策 recordtemplate ### 最終 technology 棧 choice **決策 date：** 2024年12月 **決策者：** projectteam **choice 的 technology 棧：** - **back 端 language：** Node.js - **back 端 framework：** NestJS + TypeScript - **front 端：** React.js + TypeScript + Ant Design - **datalibrary：** PostgreSQL + Prisma ORM + Redis - **archivestorage：** MinIO (S3 compatibility) - **authenticationservice：** Keycloak (開源 OAuth) - **即時通訊：** Socket.io - **analysismonitoring：** Plausible + Grafana + Prometheus - **test：** Jest + Supertest - **deployment：** Docker + Docker Compose (Self-Hosted) ### 決策理由 **main 考量因素：** 1. **teamskill：** JavaScript/TypeScript 生態 systemfamiliar 度 high，learning 曲線平緩 2. **project 時程：** fast 速 development 和原型製作，豐富的 npm 生態 system 3. **performancedemand：** 適合 I/O 密集型 application，良 good 的併發 processingcapability 4. **maintenanceexpect：** strong 型別 support，優秀的 development 者體驗和 toolchain 5. **specialdemand：** 優秀的 AI/ML integrationcapability，豐富的第三方 serviceintegration **choice 理由：** - NestJS provideenterprise 級 architecturepattern，supportdependencyinjection 和 module 化 design - TypeScript providestrong 型別 support，提 highcode 品質和 development 效率 - 與 front 端 React + TypeScript technology 棧 consistency，降 lowtechnologycomplex 度 - 豐富的生態 system 和社群 support - 優秀的 developmenttool 和調試體驗 - 適合 fast 速迭代和敏捷 development **備選 solution：** Python + FastAPI, Go + Gin **riskassessment：** - 單 executing 緒 featurepossiblein CPU 密集型 missionuptable 現不佳 - neednotice 記憶體 manage 和 performance 優化 - dependencymanageneed 謹慎 processingversionconflict ## fileupdatinglist incertaintechnology 棧 back，needupdating 以 downfile： ### mustupdating 的 file #### 1. productdemandfile (PRD) **filepath：** `docs/requirements/prd.md` **updatinglocation：** 第 4.1 節 - technology 棧 option 與 comparison **updatingcontent：** - 將「recommendationtechnology 棧 combine」partialupdating 為最終 choice - remove 其他 option，保留 choice 的 technology 棧 detailedexplanation - updatingchoicebasis 為實際決策理由 #### 2. systemarchitecturefile **filepath：** `docs/architecture/system-architecture.md` **updatinglocation：** 多個 location **updatingcontent：** - updatingarchitecturediagrammedium 的 technology 標註 - updating 各 service 的 technologyrealizeexplanation - updatingdeploymentarchitecturemedium 的 technology 細節 - updatingperformance 優化 strategy（basischoice 的 technology） #### 3. API designfile **filepath：** `docs/api/api-design.md` **updatinglocation：** API specificationpartial **updatingcontent：** - updating API framework 相關的 designpattern - updatingerrorprocessingformat（basisframeworkfeature） - updatingauthenticationrealizeway #### 4. datalibrarydesignfile **filepath：** `docs/database/schema-design.md` **updatinglocation：** ORM 和 migrationstrategy **updatingcontent：** - updating ORM choice（Prisma for Node.js, SQLAlchemy for Python 等） - updatingmigrationtool 和 strategy - updatingconnection 池 configuring #### 5. developmentenvironmentsettings **filepath：** `docs/development/setup.md` **updatinglocation：** systemdemand 和 installingstep **updatingcontent：** - updatinglanguageversionrequirement - updatingdependencyinstallingcommand - updatingdevelopmenttoolconfiguring - updatingenvironmentvariablesettings #### 6. TDD guide **filepath：** `docs/development/tdd-guidelines.md` **updatinglocation：** testframework 和 tool **updatingcontent：** - updatingtestframeworkchoice - updatingtesttoolconfiguring - updating CI/CD configuring #### 7. teststrategy **filepath：** `docs/testing/testing-strategy.md` **updatinglocation：** tool 和 frameworkpartial **updatingcontent：** - updatingtestframeworklist - updatingtesttoolconfiguring - updatingperformancetesttool #### 8. projectmanagefile **filepath：** `docs/project-management/task-breakdown.md` **updatinglocation：** technologymissionpartial **updatingcontent：** - updatingprojectinitializingmission - updatingtechnology 相關的 developmentmission - updatingdeployment 和 maintenancemission #### 9. TaskMaster PRD **filepath：** `.taskmaster/docs/prd.txt` **updatinglocation：** back 端 technology 棧 partial **updatingcontent：** - updatingtechnology 棧 description - updating 相關的 technologydemand ### needcreate 的 newfile #### 1. technology 棧實施 plan **filepath：** `docs/development/implementation-plan.md` **contentinclude：** - technology 棧 migrationplan（如果 need） - learningresource 和 trainingplan - developmentenvironment 搭建 step - 初始 projectstructure #### 2. dependencymanagefile **basischoice 的 technologycreate：** - Node.js: `package.json` - Python: `requirements.txt` 或 `pyproject.toml` - Go: `go.mod` - Java: `pom.xml` 或 `build.gradle` - Rust: `Cargo.toml` - C#: `.csproj` #### 3. developmenttoolconfiguring **basistechnology 棧 create：** - `.eslintrc.js` (Node.js/TypeScript) - `.prettierrc` (通用 format 化) - `pyproject.toml` (Python) - `.editorconfig` (通用 edit 器 configuring) ## updatingexecutingstep ### step 1：record 決策 1. 填寫 up 述「決策 recordtemplate」 2. 將決策 recordsubmit 到 versioncontrolsystem 3. notificationteammembertechnology 決策 result ### step 2：批量 updatingfile 1. 按照 up 述 list 逐一 updatingfile 2. 確保 alltechnology 相關的 description 保持 consistency 3. remove 不相關的 technologyoptionexplanation ### step 3：createnewfile 1. basischoice 的 technology 棧 create 相應的 configuringfile 2. establish 初始的 projectstructure 3. settingsdevelopmentenvironment ### step 4：verificationupdating 1. checkallfile 的 technologydescriptionyes 否 consistency 2. confirmation 沒 have 遺漏的 updating 點 3. 進行 documentation 審查 ### step 5：teamsync 1. updatingteamdevelopmentenvironment 2. 進行 technologytraining（如 need） 3. start 實際 developmentwork ## 常見 technology 棧的 specificupdatingguide ### 如果 choice Node.js + NestJS **mainupdating 點：** - all "Node.js 或 Python" 改為 "Node.js + NestJS + TypeScript" - updating ORM 為 Prisma - updatingtestframework 為 Jest + Supertest - updating API documentationtool 為 Swagger (NestJS 內建) **needcreate 的 file：** ``` package.json tsconfig.json nest-cli.json .eslintrc.js .prettierrc ``` ### 如果 choice Python + FastAPI **mainupdating 點：** - all "Node.js 或 Python" 改為 "Python + FastAPI" - updating ORM 為 SQLAlchemy 或 Tortoise ORM - updatingtestframework 為 pytest + httpx - updating API documentation 為自動 generate 的 OpenAPI **needcreate 的 file：** ``` requirements.txt pyproject.toml .python-version pytest.ini ``` ### 如果 choice Go + Gin **mainupdating 點：** - all "Node.js 或 Python" 改為 "Go + Gin" - updating ORM 為 GORM - updatingtestframework 為 Go 內建 testing + testify - updatingdeployment 為 single 二進制 file **needcreate 的 file：** ``` go.mod go.sum Makefile .golangci.yml ``` ## technology 債務 manage ### migrationplan 如果 need 從一個 technology 棧 migration 到另一個： 1. **assessment 現 havecode** 2. **制定 migration 時程** 3. **establish 並行 developmentplan** 4. **settingsdatamigrationstrategy** 5. **planningtest 和 verificationprocess** ### risk 緩解 1. **technologyrisk** - establishtechnology 原型 verification - settings 回退 plan - 進行 performance 基準 test 2. **teamrisk** - provide 充足的 learningtime - 安排 technologytraining - establishknowledgesharemechanism 3. **projectrisk** - 分 stage 實施 - 保持 documentationsync - 定期進行 technology 審查 ## back 續 action completetechnology 決策和 fileupdatingback： 1. **establishdevelopmentenvironment** 2. **create 初始 projectstructure** 3. **settings CI/CD 流水線** 4. **startcorefunctiondevelopment** 5. **定期 technology 回顧和調整** --- **notice：** 此 fileshouldintechnology 決策 certainback 立即 updating，並作為 projecttechnologydocumentation 的 important 組成 partial 進行 maintenance。